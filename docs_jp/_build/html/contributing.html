

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contributing &mdash; Solidity 0.5.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Frequently Asked Questions" href="frequently-asked-questions.html" />
    <link rel="prev" title="List of Known Bugs" href="bugs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Solidity
          

          
          </a>

          
            
            
              <div class="version">
                0.5.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction-to-smart-contracts.html">Introduction to Smart Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing-solidity.html">Installing the Solidity Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidity-by-example.html">Solidity by Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidity-in-depth.html">Solidity in Depth</a></li>
<li class="toctree-l1"><a class="reference internal" href="security-considerations.html">Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-the-compiler.html">Using the compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Contract Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="abi-spec.html">Contract ABI Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="yul.html">Yul</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guide.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-patterns.html">Common Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="bugs.html">List of Known Bugs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-report-issues">How to Report Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#workflow-for-pull-requests">Workflow for Pull Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-compiler-tests">Running the compiler tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#writing-and-running-syntax-tests">Writing and running syntax tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-fuzzer-via-afl">Running the Fuzzer via AFL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#whiskers">Whiskers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="frequently-asked-questions.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lll.html">LLL</a></li>
</ul>

            
          
    <a href="genindex.html">Keyword Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Solidity</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Contributing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/contributing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h1>
<p>貢献はいつでも歓迎します</p>
<p>始めるには、まず、Solidityのコンポーネントとビルドプロセスを理解するため、<a class="reference internal" href="installing-solidity.html#building-from-source"><span class="std std-ref">Building from Source</span></a> を確認してください。
また、Solidityでスマートコントラクトを書くことに精通することも役立つでしょう。</p>
<p>以下の領域が特に手助けが必要です。</p>
<ul class="simple">
<li>ドキュメントを改善する</li>
<li><a class="reference external" href="https://ethereum.stackexchange.com">StackExchange</a> や <a class="reference external" href="https://gitter.im/ethereum/solidity">Solidity Gitter</a> に投稿されたユーザーからの質問に答える</li>
<li><a class="reference external" href="https://github.com/ethereum/solidity/issues">Solidity’s GitHub issues</a> に投稿されたissueに回答し修正する。特にこのタグがついた <a class="reference external" href="https://github.com/ethereum/solidity/labels/good%20first%20issue">good first issue</a> ものは外部貢献者のための入門的なissueになります。</li>
</ul>
<p>このプロジェクト(issues, pull requests, Gitter channels含む) は <a class="reference external" href="https://raw.githubusercontent.com/ethereum/solidity/develop/CODE_OF_CONDUCT.md">Contributor Code of Conduct</a> でリリースされていることに注意してください。
あなたはこの規約に同意することになります。</p>
<div class="section" id="how-to-report-issues">
<h2>How to Report Issues<a class="headerlink" href="#how-to-report-issues" title="Permalink to this headline">¶</a></h2>
<p>issueの報告には、
<a class="reference external" href="https://github.com/ethereum/solidity/issues">GitHub issues tracker</a>
を使って、以下の項目を含めるようにしてください。</p>
<ul class="simple">
<li>どのSolidityバージョンをつかっているのか</li>
<li>どんなソースコードだったのか(可能であれば)</li>
<li>どのプラットフォームで実行していたか</li>
<li>再現方法</li>
<li>issueの結果はどのようなものか</li>
<li>期待する動作はどのようなものか</li>
</ul>
<p>issueを再現するために最低限のソースコードにするのは有用で、誤解を明らかにします。</p>
</div>
<div class="section" id="workflow-for-pull-requests">
<h2>Workflow for Pull Requests<a class="headerlink" href="#workflow-for-pull-requests" title="Permalink to this headline">¶</a></h2>
<p>貢献するために、 <code class="docutils literal notranslate"><span class="pre">develop</span></code> ブランチをフォークし、あなたの変更をそこにいれてください。
コミットメッセージには、あなたの変更(小さな変更でなければ)の <em>what</em> に加えて <em>why</em> を詳細にいれるべきです。</p>
<p>もしあなたが変更を加えた後に <code class="docutils literal notranslate"><span class="pre">develop</span></code> からpullする必要がある場合(例えばコンフリクトのマージする)、
私たちがあなたの変更のレビューをするのを簡単にするため、
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code> を使うことは避けて、 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> を使ってください。</p>
<p>また、追加の機能を実装している場合、適切なテストケースを <code class="docutils literal notranslate"><span class="pre">test/</span></code> に追加してください。(下記参照)</p>
<p>しかし、もし大きな変更をする場合、まず、
<a class="reference external" href="https://gitter.im/ethereum/solidity-dev">Solidity Development Gitter channel</a>
に相談してください。
(上記で参照したものとは異なり、こちらはコンパイラと言語開発用です)</p>
<p>新機能とバグ修正は <code class="docutils literal notranslate"><span class="pre">Changelog.md</span></code> に追加されるべきです。
前回のエントリーのスタイルにしたがってください。</p>
<p>最後に、このプロジェクトでは、<a class="reference external" href="https://github.com/ethereum/solidity/blob/develop/CODING_STYLE.md">coding style</a>
を尊重してください。
私たちがCIテストを実行してはいますが、pull requestsを送る前にはローカルでテストしビルドするようにしてください。</p>
<p>あなたの貢献を感謝します。</p>
</div>
<div class="section" id="running-the-compiler-tests">
<h2>Running the compiler tests<a class="headerlink" href="#running-the-compiler-tests" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">./scripts/tests.sh</span></code> スクリプトはほとんどのSolidityテストを実行し、<code class="docutils literal notranslate"><span class="pre">aleth</span></code> を走らせます。
<code class="docutils literal notranslate"><span class="pre">aleth</span></code> がパスに見つかる場合は実行しますが、ダウンロードは行いませんので、最初にインストールしておく必要があります。
詳細を確認してください。</p>
<p>Solidityは様々なテストを含んでおり、ほとんどが <code class="docutils literal notranslate"><span class="pre">soltest</span></code> アプリケーションに同包されています。
それらのいくつかはテストモードで　<code class="docutils literal notranslate"><span class="pre">aleth</span></code> クライアントを必要とし、<code class="docutils literal notranslate"><span class="pre">libz3</span></code> を必要とするものもあります。</p>
<p><code class="docutils literal notranslate"><span class="pre">aleth</span></code> も <code class="docutils literal notranslate"><span class="pre">libz3</span></code> も必要としない基本的なテストセットを実行するには、
<code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">--no-ipc</span> <span class="pre">--no-smt</span></code> を実行します。
このスクリプトは <code class="docutils literal notranslate"><span class="pre">./build/test/soltest</span></code> を内部的に走らせます。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Windows環境のこれらの作業で、上記の基本的なテストセットをGit Bash上でalethやlibz3なしで実行したい場合、
<code class="docutils literal notranslate"><span class="pre">./build/test/Release/soltest.exe</span> <span class="pre">--</span> <span class="pre">--no-ipc</span> <span class="pre">--no-smt</span></code> このコマンドを実行する必要があるでしょう。もし標準のコマンドプロンプトで実行する場合は、 <code class="docutils literal notranslate"><span class="pre">.\build\test\Release\soltest.exe</span> <span class="pre">--</span> <span class="pre">--no-ipc</span> <span class="pre">--no-smt</span></code> を実行します。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--no-smt</span></code> オプションは <code class="docutils literal notranslate"><span class="pre">libz3</span></code> を必要とするテストを無効にし、 <code class="docutils literal notranslate"><span class="pre">--no-ipc</span></code> オプションは <code class="docutils literal notranslate"><span class="pre">aleth</span></code> を必要とするテストを無効にします。</p>
<p>ipcテスト(生成されたコードのセマンティックをテストするもの)を実行したい場合、
<a class="reference external" href="https://github.com/ethereum/aleth/releases/download/v1.5.0-alpha.7/aleth-1.5.0-alpha.7-linux-x86_64.tar.gz">aleth</a>
をインストールします。
その後、テストモードで実行します。
<code class="docutils literal notranslate"><span class="pre">aleth</span> <span class="pre">--db</span> <span class="pre">memorydb</span> <span class="pre">--test</span> <span class="pre">-d</span> <span class="pre">/tmp/testeth</span></code></p>
<p>実際のテストを実行するには、 <code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">--ipcpath</span> <span class="pre">/tmp/testeth/geth.ipc</span></code> を使います。</p>
<p>テストの一部を実行する場合は、フィルタを使います。
<code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">-t</span> <span class="pre">TestSuite/TestName</span> <span class="pre">--ipcpath</span> <span class="pre">/tmp/testeth/geth.ipc</span></code>
<code class="docutils literal notranslate"><span class="pre">TestName</span></code> はワイルドカードを指定できます <code class="docutils literal notranslate"><span class="pre">*</span></code>。</p>
<p>例えば、実行したテストがあるとして、
<code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">-t</span> <span class="pre">&quot;yulOptimizerTests/disambiguator/*&quot;</span> <span class="pre">--no-ipc</span> <span class="pre">--no-smt</span></code>
を実行すると、disambiguatorの全てのテストが実行されます。</p>
<p>全てテストを確認するには、
<code class="docutils literal notranslate"><span class="pre">./build/test/soltest</span> <span class="pre">--list_content=HRF</span> <span class="pre">--</span> <span class="pre">--ipcpath</span> <span class="pre">/tmp/irrelevant</span></code>
を使います。</p>
<p>もしGDBでデバッグしたい場合は、通常とは異なる方法でビルドしていることが必要です。
以下のコマンドを <code class="docutils literal notranslate"><span class="pre">build</span></code> フォルダで実行します。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Debug</span> <span class="p">..</span>
<span class="n">make</span>
</pre></div>
</div>
<p>これは、あなたが <code class="docutils literal notranslate"><span class="pre">--debug</span></code> フラグを使いテストをデバッグする際のシンボルを生成します。
これで、関数や変数をbreakしたりprintで表示したりすることができるようになります。</p>
<p><code class="docutils literal notranslate"><span class="pre">./scripts/tests.sh</span></code> スクリプトも、<code class="docutils literal notranslate"><span class="pre">soltest</span></code> で見つかったテストに加えて、コマンドラインテストを実行しテストをコンパイルします。</p>
<p>CIはEmscriptenのコンパイルを必要とする追加のテスト( <code class="docutils literal notranslate"><span class="pre">solc-js</span></code> やサードパーティのSolidityフレームワークのテストを含みます)を実行します。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">いくつかの <code class="docutils literal notranslate"><span class="pre">aleth</span></code> のバージョンはテストに使うことはできません。
SolidityのCIで使っているものと同じバージョンを使うことを推奨します。
現在CIはバージョン <code class="docutils literal notranslate"><span class="pre">aleth</span></code> の <code class="docutils literal notranslate"><span class="pre">1.5.0-alpha.7</span></code> を使っています。</p>
</div>
<div class="section" id="writing-and-running-syntax-tests">
<h3>Writing and running syntax tests<a class="headerlink" href="#writing-and-running-syntax-tests" title="Permalink to this headline">¶</a></h3>
<p>構文テストは、コンパイラが無効なコードに正しいエラーメッセージを生成し、適切に有効なコードを受け入れることをチェックします。
それらは <code class="docutils literal notranslate"><span class="pre">tests/libsolidity/syntaxTests</span></code> フォルダ内へ個別のファイルに格納されます。
それらのファイルは、個別のテストケースの正しい結果とアノテーションを含んでいます。
テストスイートは、正しい結果に対してチェックしコンパイルします。</p>
<p>例えば、 <code class="docutils literal notranslate"><span class="pre">./test/libsolidity/syntaxTests/double_stateVariable_declaration.sol</span></code> では、</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">test</span> <span class="p">{</span>
    <span class="kt">uint256</span> <span class="n">variable</span><span class="p">;</span>
    <span class="kt">uint128</span> <span class="n">variable</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// ----</span>
<span class="c1">// DeclarationError: (36-52): Identifier already declared.</span>
</pre></div>
</div>
<p>構文テストは、少なくともセパレータ <code class="docutils literal notranslate"><span class="pre">//</span> <span class="pre">----</span></code> に続くテスト自身のコントラクトを含まなければいけません。
セパレータに続くコメントは、正しいコンパイラエラーやワーニングを記述するのに使われます。
数字の範囲は、エラーが発生したソースコードの場所を指定しています。
コントラクトにエラーやワーニングなしでコンパイルしたい場合、セパレータとコメントを削除することができます。</p>
<p>上記の例だと、<code class="docutils literal notranslate"><span class="pre">variable</span></code> 変数は２度宣言されてます。
これは、すでに宣言されていますという識別子の <code class="docutils literal notranslate"><span class="pre">DeclarationError</span></code> となります。</p>
<p><code class="docutils literal notranslate"><span class="pre">isoltest</span></code> というツールはこれらのテストに使え、<code class="docutils literal notranslate"><span class="pre">./build/test/tools/</span></code> にあります。
このツールは、対話的に、お好みのエディタを使って、失敗しているコントラクトを編集することができます。
<code class="docutils literal notranslate"><span class="pre">variable</span></code> を削除して、このテストを突破してみましょう！</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">test</span> <span class="p">{</span>
    <span class="kt">uint256</span> <span class="n">variable</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// ----</span>
<span class="c1">// DeclarationError: (36-52): Identifier already declared.</span>
</pre></div>
</div>
<p>再度 <code class="docutils literal notranslate"><span class="pre">./build/test/isoltest</span></code> を実行すると失敗します。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">syntaxTests</span><span class="o">/</span><span class="n">double_stateVariable_declaration</span><span class="p">.</span><span class="n">sol</span><span class="o">:</span> <span class="n">FAIL</span>
    <span class="n">Contract</span><span class="o">:</span>
        <span class="kd">contract</span> <span class="n">test</span> <span class="p">{</span>
            <span class="kt">uint256</span> <span class="n">variable</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="n">Expected</span> <span class="n">result</span><span class="o">:</span>
        <span class="n">DeclarationError</span><span class="o">:</span> <span class="p">(</span><span class="mi">36</span><span class="o">-</span><span class="mi">52</span><span class="p">)</span><span class="o">:</span> <span class="n">Identifier</span> <span class="n">already</span> <span class="n">declared</span><span class="p">.</span>
    <span class="n">Obtained</span> <span class="n">result</span><span class="o">:</span>
        <span class="n">Success</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">isoltest</span></code> は得られた結果の次に期待する結果を表示します。また、現在のコントラクトの編集や更新、スキップする方法や、アプリケーションを終了する方法など方法も提供します。</p>
<p>失敗してるテストのためにいくつかの選択肢を提供します。</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">edit</span></code>: <code class="docutils literal notranslate"><span class="pre">isoltest</span></code> はエディタでコントラクトを開こうとし、修正できるます。 <code class="docutils literal notranslate"><span class="pre">isoltest</span> <span class="pre">--editor</span> <span class="pre">/path/to/editor</span></code> としてコマンドラインで与えられたエディタか、<code class="docutils literal notranslate"><span class="pre">EDITOR</span></code> 環境変数で設定されいてるものか <code class="docutils literal notranslate"><span class="pre">/usr/bin/editor</span></code> を使います。(この順番で設定されます).</li>
<li><code class="docutils literal notranslate"><span class="pre">update</span></code>: テストのコントラクトの期待値を更新します。 満たされていない期待値を取り除き、不足している期待値を追加することアノテーションを更新します。このテストは再度実行されます。</li>
<li><code class="docutils literal notranslate"><span class="pre">skip</span></code>: 特定のテストの実行をスキップします。</li>
<li><code class="docutils literal notranslate"><span class="pre">quit</span></code>: <code class="docutils literal notranslate"><span class="pre">isoltest</span></code> を終了します。</li>
</ul>
<p>全てのテスト実行を終了する <code class="docutils literal notranslate"><span class="pre">quit</span></code> をのぞいて全てのオプションは現在のコントラクトへ適用します。</p>
<p>自動的、上記のテストは以下に変更され、</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">test</span> <span class="p">{</span>
    <span class="kt">uint256</span> <span class="n">variable</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// ----</span>
</pre></div>
</div>
<p>再実行され、テストはパスします。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">Re</span><span class="o">-</span><span class="n">running</span> <span class="n">test</span> <span class="n">case</span><span class="p">...</span>
<span class="n">syntaxTests</span><span class="o">/</span><span class="n">double_stateVariable_declaration</span><span class="p">.</span><span class="n">sol</span><span class="o">:</span> <span class="n">OK</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">そのテストを説明するコントラクトファイルの名前を選んでみてください。例えば、<code class="docutils literal notranslate"><span class="pre">double_variable_declaration.sol</span></code> などです。
継承のテストやクロスコントラクトのテスト以外で、1つのファイルに複数のコントラクトを配置していはいけません。
各ファイルは新しい機能の側面のみテストすべきです。</p>
</div>
</div>
</div>
<div class="section" id="running-the-fuzzer-via-afl">
<h2>Running the Fuzzer via AFL<a class="headerlink" href="#running-the-fuzzer-via-afl" title="Permalink to this headline">¶</a></h2>
<p>Fuzzingは例外的な状態(segmentation faults, exceptions, etc)を見つけるための、ランダムインプットでプログラムを実行させるテクニックです。</p>
<p>現代のfuzzersはかしこく、インプットの中で有向探索を実行します。
インプットとして、ソースコードをとる <code class="docutils literal notranslate"><span class="pre">solfuzzer</span></code> と呼ばれる特別なバイナリがあります。
内部コンパイラエラー、やsegmentation faultや類似のエラーが発生した時は失敗しますが、
コードにエラーが含まれていても失敗しません。こうして、fuzzingツールはコンパイラの中の内部的な問題を見つけることができます。</p>
<p>私たちは主に、 <cite>AFL &lt;http://lcamtuf.coredump.cx/afl/&gt;</cite> をfuzzingに使います。リポジトリ(afl, afl-clang)からAFLパッケージをダウンロードしインストールか、手動でビルドする必要があります。
次に、自分用のコンパイラとしてAFLとSolidityをビルドします（もしくは、単に <code class="docutils literal notranslate"><span class="pre">solfuzzer</span></code> バイナリを使います）。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="err">#</span> <span class="k">if</span> <span class="n">needed</span>
<span class="n">make</span> <span class="n">clean</span>
<span class="n">cmake</span> <span class="p">..</span> <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">afl</span><span class="o">-</span><span class="n">gcc</span> <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">afl</span><span class="o">-</span><span class="n">g</span><span class="o">++</span>
<span class="n">make</span> <span class="n">solfuzzer</span>
</pre></div>
</div>
<p>この段階では以下のようなメッセージを見ることになるでしょう。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">Scanning</span> <span class="n">dependencies</span> <span class="n">of</span> <span class="n">target</span> <span class="n">solfuzzer</span>
<span class="p">[</span> <span class="mi">98</span><span class="o">%</span><span class="p">]</span> <span class="n">Building</span> <span class="n">CXX</span> <span class="n">object</span> <span class="n">test</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">CMakeFiles</span><span class="o">/</span><span class="n">solfuzzer</span><span class="p">.</span><span class="n">dir</span><span class="o">/</span><span class="n">fuzzer</span><span class="p">.</span><span class="n">cpp</span><span class="p">.</span><span class="n">o</span>
<span class="n">afl</span><span class="o">-</span><span class="n">cc</span> <span class="mf">2.52</span><span class="n">b</span> <span class="n">by</span> <span class="o">&lt;</span><span class="n">lcamtuf</span><span class="err">@</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">afl</span><span class="o">-</span><span class="kr">as</span> <span class="mf">2.52</span><span class="n">b</span> <span class="n">by</span> <span class="o">&lt;</span><span class="n">lcamtuf</span><span class="err">@</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Instrumented</span> <span class="mi">1949</span> <span class="n">locations</span> <span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">,</span> <span class="n">non</span><span class="o">-</span><span class="n">hardened</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ratio</span> <span class="mi">100</span><span class="o">%</span><span class="p">).</span>
<span class="p">[</span><span class="mi">100</span><span class="o">%</span><span class="p">]</span> <span class="n">Linking</span> <span class="n">CXX</span> <span class="n">executable</span> <span class="n">solfuzzer</span>
</pre></div>
</div>
<p>このようなメッセージ表示されない場合、cmakeフラグをAFLのclangバイナリに向けるようにしてみてください。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="err">#</span> <span class="k">if</span> <span class="n">previously</span> <span class="n">failed</span>
<span class="n">make</span> <span class="n">clean</span>
<span class="n">cmake</span> <span class="p">..</span> <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">afl</span><span class="o">-</span><span class="n">clang</span> <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">afl</span><span class="o">-</span><span class="n">clang</span><span class="o">++</span>
<span class="n">make</span> <span class="n">solfuzzer</span>
</pre></div>
</div>
<p>そうしなければ、直ちにバイナリはインスツルメントされてないというエラーと共にfuzzerは停止します。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">afl</span><span class="o">-</span><span class="n">fuzz</span> <span class="mf">2.52</span><span class="n">b</span> <span class="n">by</span> <span class="o">&lt;</span><span class="n">lcamtuf</span><span class="err">@</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="p">...</span> <span class="p">(</span><span class="n">truncated</span> <span class="n">messages</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Validating</span> <span class="n">target</span> <span class="n">binary</span><span class="p">...</span>

<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">Looks</span> <span class="n">like</span> <span class="n">the</span> <span class="n">target</span> <span class="n">binary</span> <span class="kr">is</span> <span class="n">not</span> <span class="n">instrumented</span><span class="o">!</span> <span class="n">The</span> <span class="n">fuzzer</span> <span class="n">depends</span> <span class="n">on</span>
    <span class="n">compile</span><span class="o">-</span><span class="n">time</span> <span class="n">instrumentation</span> <span class="n">to</span> <span class="n">isolate</span> <span class="n">interesting</span> <span class="n">test</span> <span class="n">cases</span> <span class="k">while</span>
    <span class="n">mutating</span> <span class="n">the</span> <span class="n">input</span> <span class="n">data</span><span class="p">.</span> <span class="n">For</span> <span class="n">more</span> <span class="n">information</span><span class="p">,</span> <span class="n">and</span> <span class="k">for</span> <span class="n">tips</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span>
    <span class="n">instrument</span> <span class="n">binaries</span><span class="p">,</span> <span class="n">please</span> <span class="n">see</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">afl</span><span class="o">-</span><span class="n">doc</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">README</span><span class="p">.</span>

    <span class="n">When</span> <span class="n">source</span> <span class="n">code</span> <span class="kr">is</span> <span class="n">not</span> <span class="n">available</span><span class="p">,</span> <span class="n">you</span> <span class="n">may</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">leverage</span> <span class="n">QEMU</span>
    <span class="n">mode</span> <span class="n">support</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">README</span> <span class="k">for</span> <span class="n">tips</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span> <span class="n">enable</span> <span class="nb">this</span><span class="p">.</span>
    <span class="p">(</span><span class="n">It</span> <span class="kr">is</span> <span class="n">also</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">use</span> <span class="n">afl</span><span class="o">-</span><span class="n">fuzz</span> <span class="kr">as</span> <span class="n">a</span> <span class="n">traditional</span><span class="p">,</span> <span class="s">&quot;dumb&quot;</span> <span class="n">fuzzer</span><span class="p">.</span>
    <span class="n">For</span> <span class="n">that</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">use</span> <span class="n">the</span> <span class="o">-</span><span class="n">n</span> <span class="n">option</span> <span class="o">-</span> <span class="n">but</span> <span class="n">expect</span> <span class="n">much</span> <span class="n">worse</span> <span class="n">results</span><span class="p">.)</span>

<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">PROGRAM</span> <span class="n">ABORT</span> <span class="o">:</span> <span class="n">No</span> <span class="n">instrumentation</span> <span class="n">detected</span>
         <span class="n">Location</span> <span class="o">:</span> <span class="n">check_binary</span><span class="p">(),</span> <span class="n">afl</span><span class="o">-</span><span class="n">fuzz</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">6920</span>
</pre></div>
</div>
<p>次に、サンプルソースファイルで、それはfuzzerに簡単にエラーを見つけられるようする実例のソースコードが必要です。
あなたは、文法テストからファイルをコピーするか、ドキュメントや他のテストからテストファイルを抽出することができます。</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">test_cases</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">test_cases</span>
<span class="err">#</span> <span class="n">extract</span> <span class="kr">from</span> <span class="n">tests</span><span class="o">:</span>
<span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">solidity</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">isolate_tests</span><span class="p">.</span><span class="n">py</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">solidity</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">libsolidity</span><span class="o">/</span><span class="n">SolidityEndToEndTest</span><span class="p">.</span><span class="n">cpp</span>
<span class="err">#</span> <span class="n">extract</span> <span class="kr">from</span> <span class="n">documentation</span><span class="o">:</span>
<span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">solidity</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">isolate_tests</span><span class="p">.</span><span class="n">py</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">solidity</span><span class="o">/</span><span class="n">docs</span> <span class="n">docs</span>
</pre></div>
</div>
<p>AFLドキュメントはコーパス（初期のインプットファイル）が大きすぎないようにしています。これらのファイル自身は1 kBを超えず、機能あたり多くても１ファイルであるべきです。
<code class="docutils literal notranslate"><span class="pre">afl-cmin</span></code> というインプットファイルをバイナリと似た動作に整えるツールもあります。</p>
<p>fuzzerを実行してください( <code class="docutils literal notranslate"><span class="pre">-m</span></code> はメモリサイズを60 MBへ拡張します):</p>
<div class="highlight-Solidity notranslate"><div class="highlight"><pre><span></span><span class="n">afl</span><span class="o">-</span><span class="n">fuzz</span> <span class="o">-</span><span class="n">m</span> <span class="mi">60</span> <span class="o">-</span><span class="n">i</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">test_cases</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">fuzzer_reports</span> <span class="o">--</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">solfuzzer</span>
</pre></div>
</div>
<p>fuzzerは <code class="docutils literal notranslate"><span class="pre">/tmp/fuzzer_reports</span></code> に失敗するソースファイルを生成します。
同じエラーを発生させる似たソースファイルがあることもありますが、 <code class="docutils literal notranslate"><span class="pre">scripts/uniqueErrors.sh</span></code> を使うとユニークなエラーのみ絞り込むことができます。</p>
</div>
<div class="section" id="whiskers">
<h2>Whiskers<a class="headerlink" href="#whiskers" title="Permalink to this headline">¶</a></h2>
<p><em>Whiskers</em> は <cite>Mustache &lt;https://mustache.github.io&gt;</cite> と似た文字型テンプレートシステムです。
コードの保守性や検証可能性、可読性のため、様々な場所でコンパイラが使います。</p>
<p>シンタックスはMustacheと大きく異なり、 <code class="docutils literal notranslate"><span class="pre">{{</span></code> と <code class="docutils literal notranslate"><span class="pre">}}</span></code> は　<code class="docutils literal notranslate"><span class="pre">&lt;</span></code> と <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> に置き換わっています。
それはパースしやすくするのと、 <a class="reference internal" href="assembly.html#inline-assembly"><span class="std std-ref">Inline Assembly</span></a> とコンフリクトするのを避けるためです(インラインアセンブラでは <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> と <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> は不正ですが、 <code class="docutils literal notranslate"><span class="pre">{</span></code> と <code class="docutils literal notranslate"><span class="pre">}</span></code> はブロックを区切るのに使います)
リストは１階層のみ処理され再帰しない、という制限がありますが、将来は変更されるでしょう。</p>
<p>A rough specification is the following:
大まかな仕様として以下があります。</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> は全て文字型の <code class="docutils literal notranslate"><span class="pre">name</span></code> にエスケープや繰り返しの置換することなしに置き換われます。
領域は <code class="docutils literal notranslate"><span class="pre">&lt;#name&gt;...&lt;/name&gt;</span></code> で区切ることができます。テンプレートシステムへ与えられた変数のセットとして、内容を連結したものに置きかわりますし、
<code class="docutils literal notranslate"><span class="pre">&lt;inner&gt;</span></code> は毎回、それぞれの値で置き換わります。
トップレベルの変数はその領域内部でも使うことができます。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="frequently-asked-questions.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bugs.html" class="btn btn-neutral float-left" title="List of Known Bugs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, Ethereum

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>